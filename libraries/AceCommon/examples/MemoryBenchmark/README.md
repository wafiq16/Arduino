# Memory Benchmark

The `MemoryBenchmark.ino` was compiled with each `FEATURE_*` and the flash
memory and static RAM sizes were recorded. The `FEATURE_BASELINE` selection is
the baseline, and its memory usage numbers are subtracted from the subsequent
`FEATURE_*` memory usage.

**Version**: AceCommon v1.5.0

**DO NOT EDIT**: This file was auto-generated using `make README.md`.

## How to Regenerate

To regenerate this README.md:

```
$ make clean_benchmarks
$ make benchmarks
$ make README.md
```

The `make benchmarks` target uses `collect.sh` script which calls `auniter.sh`
(https://github.com/bxparks/AUniter) to invoke the Arduino IDE programmatically.
It produces a `*.txt` file with the flash and ram usage information (e.g.
`nano.txt`).

The `make README.md` command calls the `generated_readme.py` Python script which
generates this `README.md` file. The ASCII tables below are generated by the
`generate_table.awk` script, which takes each `*.txt` file and converts it to an
ASCII table.

## Library Size Changes

**v1.4.5**

* Upgrading from ESP32 Core v1.0.4 to v1.0.6 causes `PrintStrN` to be about
  1300 bytes larger than `PrintStr`, probably because the `new` and `delete`
  operators bring in more complex code. But the overall ESP32 flash usage goes
  down by 7.5 kB compared to v1.0.4, so this is probably not something to worry
  about.
* Added benchmarks for `udiv1000()` and native `/1000`. The `udiv1000()`
  function consumes about 180 bytes on 8-bit AVR processors, more than the
  native division by `/1000` which takes about 130 bytes.

**v1.4.6**

* Upgrade STM32duino Core from 1.9.0 to 2.0.0.
    * Flash memory increases by 2.3kB across the board.
    * Static memory decreases by 250 bytes across the board.
    * AceCommon code unchanged.
* Upgrade SparkFun SAMD Core from 1.8.1 to 1.8.3.
    * No changes to flash or static memory.
* Add benchmark for `String` so to compare with `PrintStr<N>` and `PrintStrN`.
    * Pull in `Serial` into the Baseline to compensate for pulling in the
      `Print` class, the parent class of `PrintStr` and `PrintStrN`.
* Add benchmark for `isSorted()`.
    * Add `array[100]` into Baseline to compensate for its use in `isSorted()`.
* Add benchmark for `printUint16AsFloat3To()` and `printUint32AsFloat3To()`.

**v1.4.7**

* Add benchmarks for `KString::compareTo(const KString&)`.
* Upgrade Arduino IDE from 1.8.13 to 1.8.16.
* Upgrade Arduino CLI from 0.14.0 to 0.19.2
* Upgrade SparkFun SAMD Core from 1.8.3 to 1.8.5.
* Upgrade ESP8266 Core from 2.7.4 to 3.0.2.
* Upgrade Teensyduino from 1.53 to 1.55.

**v1.5.0**

* Remove SAMD21 board.
* Add benchmark for `backslashXEncode()` and `backslashXDecode()`.
* Upgrade Arduino IDE from 1.8.16 to 1.8.19.
* Upgrade Arduino CLI from 0.19.2 to 0.20.2.
* Upgrade Arduino AVR Core from 1.8.3 to 1.8.4.
* Upgrade STM32 Core from 2.0.0 to 2.2.0.
* Upgrade ESP32 Core from 1.0.6 to 2.0.2.
* Upgrade Teensyduino from 1.55 to 1.56.

## Arduino Nano

* 16MHz ATmega328P
* Arduino IDE 1.8.19, Arduino CLI 0.20.2
* Arduino AVR Boards 1.8.4

```
+---------------------------------------------------------------------+
| Functionality                          |  flash/  ram |       delta |
|----------------------------------------+--------------+-------------|
| Baseline                               |   2146/  289 |     0/    0 |
|----------------------------------------+--------------+-------------|
| String                                 |   3620/  301 |  1474/   12 |
| PrintStr<16>                           |   2520/  301 |   374/   12 |
| PrintStrN(16)                          |   3124/  311 |   978/   22 |
|----------------------------------------+--------------+-------------|
| printPad2()                            |   2230/  289 |    84/    0 |
| printPad5()                            |   2248/  289 |   102/    0 |
| printUint16AsFloat3To()                |   2242/  289 |    96/    0 |
| printUint32AsFloat3To()                |   2246/  289 |   100/    0 |
|----------------------------------------+--------------+-------------|
| printReplaceCharTo(char*)              |   2186/  293 |    40/    4 |
| printReplaceCharTo(F())                |   2182/  289 |    36/    0 |
| printReplaceStringTo(char*)            |   2204/  295 |    58/    6 |
| printReplaceStringTo(F())              |   2200/  291 |    54/    2 |
|----------------------------------------+--------------+-------------|
| hashDjb2(char*)                        |   2212/  289 |    66/    0 |
| hashDjb2(F())                          |   2212/  289 |    66/    0 |
|----------------------------------------+--------------+-------------|
| udiv1000()                             |   2282/  289 |   136/    0 |
| /1000                                  |   2216/  289 |    70/    0 |
|----------------------------------------+--------------+-------------|
| isSorted()                             |   2182/  289 |    36/    0 |
| reverse()                              |   2178/  289 |    32/    0 |
|----------------------------------------+--------------+-------------|
| KString::compareTo(char*)              |   2270/  317 |   124/   28 |
| KString::compareTo(KString&)           |   2516/  311 |   370/   22 |
|----------------------------------------+--------------+-------------|
| backslashXEncode()                     |   2308/  295 |   162/    6 |
| backslashXDecode()                     |   2364/  301 |   218/   12 |
+---------------------------------------------------------------------+

```

## Sparkfun Pro Micro

* 16 MHz ATmega32U4
* Arduino IDE 1.8.19, Arduino CLI 0.20.2
* SparkFun AVR Boards 1.1.13

```
+---------------------------------------------------------------------+
| Functionality                          |  flash/  ram |       delta |
|----------------------------------------+--------------+-------------|
| Baseline                               |   4268/  254 |     0/    0 |
|----------------------------------------+--------------+-------------|
| String                                 |   5742/  264 |  1474/   10 |
| PrintStr<16>                           |   4636/  266 |   368/   12 |
| PrintStrN(16)                          |   5246/  276 |   978/   22 |
|----------------------------------------+--------------+-------------|
| printPad2()                            |   4352/  254 |    84/    0 |
| printPad5()                            |   4368/  254 |   100/    0 |
| printUint16AsFloat3To()                |   4364/  254 |    96/    0 |
| printUint32AsFloat3To()                |   4368/  254 |   100/    0 |
|----------------------------------------+--------------+-------------|
| printReplaceCharTo(char*)              |   4308/  258 |    40/    4 |
| printReplaceCharTo(F())                |   4304/  254 |    36/    0 |
| printReplaceStringTo(char*)            |   4326/  260 |    58/    6 |
| printReplaceStringTo(F())              |   4322/  256 |    54/    2 |
|----------------------------------------+--------------+-------------|
| hashDjb2(char*)                        |   4334/  254 |    66/    0 |
| hashDjb2(F())                          |   4334/  254 |    66/    0 |
|----------------------------------------+--------------+-------------|
| udiv1000()                             |   4404/  254 |   136/    0 |
| /1000                                  |   4338/  254 |    70/    0 |
|----------------------------------------+--------------+-------------|
| isSorted()                             |   4304/  254 |    36/    0 |
| reverse()                              |   4300/  254 |    32/    0 |
|----------------------------------------+--------------+-------------|
| KString::compareTo(char*)              |   4392/  282 |   124/   28 |
| KString::compareTo(KString&)           |   4638/  276 |   370/   22 |
|----------------------------------------+--------------+-------------|
| backslashXEncode()                     |   4430/  260 |   162/    6 |
| backslashXDecode()                     |   4502/  266 |   234/   12 |
+---------------------------------------------------------------------+

```

## STM32 Blue Pill

* STM32F103C8, 72 MHz ARM Cortex-M3
* Arduino IDE 1.8.19, Arduino CLI 0.20.2
* STM32duino 2.2.0

```
+---------------------------------------------------------------------+
| Functionality                          |  flash/  ram |       delta |
|----------------------------------------+--------------+-------------|
| Baseline                               |  27476/ 3752 |     0/    0 |
|----------------------------------------+--------------+-------------|
| String                                 |  28032/ 3752 |   556/    0 |
| PrintStr<16>                           |  27636/ 3752 |   160/    0 |
| PrintStrN(16)                          |  27652/ 3752 |   176/    0 |
|----------------------------------------+--------------+-------------|
| printPad2()                            |  27572/ 3752 |    96/    0 |
| printPad5()                            |  27596/ 3752 |   120/    0 |
| printUint16AsFloat3To()                |  27580/ 3752 |   104/    0 |
| printUint32AsFloat3To()                |  27584/ 3752 |   108/    0 |
|----------------------------------------+--------------+-------------|
| printReplaceCharTo(char*)              |  27508/ 3752 |    32/    0 |
| printReplaceCharTo(F())                |  27508/ 3752 |    32/    0 |
| printReplaceStringTo(char*)            |  27528/ 3752 |    52/    0 |
| printReplaceStringTo(F())              |  27528/ 3752 |    52/    0 |
|----------------------------------------+--------------+-------------|
| hashDjb2(char*)                        |  27500/ 3752 |    24/    0 |
| hashDjb2(F())                          |  27508/ 3752 |    32/    0 |
|----------------------------------------+--------------+-------------|
| udiv1000()                             |  27516/ 3752 |    40/    0 |
| /1000                                  |  27508/ 3752 |    32/    0 |
|----------------------------------------+--------------+-------------|
| isSorted()                             |  27512/ 3752 |    36/    0 |
| reverse()                              |  27508/ 3752 |    32/    0 |
|----------------------------------------+--------------+-------------|
| KString::compareTo(char*)              |  27644/ 3752 |   168/    0 |
| KString::compareTo(KString&)           |  27720/ 3752 |   244/    0 |
|----------------------------------------+--------------+-------------|
| backslashXEncode()                     |  27684/ 3752 |   208/    0 |
| backslashXDecode()                     |  27724/ 3752 |   248/    0 |
+---------------------------------------------------------------------+

```

## ESP8266

* NodeMCU 1.0, 80MHz ESP8266
* Arduino IDE 1.8.19, Arduino CLI 0.20.2
* ESP8266 Boards 3.0.2

```
+---------------------------------------------------------------------+
| Functionality                          |  flash/  ram |       delta |
|----------------------------------------+--------------+-------------|
| Baseline                               | 265613/28104 |     0/    0 |
|----------------------------------------+--------------+-------------|
| String                                 | 265713/28100 |   100/   -4 |
| PrintStr<16>                           | 265821/28104 |   208/    0 |
| PrintStrN(16)                          | 265921/28104 |   308/    0 |
|----------------------------------------+--------------+-------------|
| printPad2()                            | 265773/28104 |   160/    0 |
| printPad5()                            | 265805/28104 |   192/    0 |
| printUint16AsFloat3To()                | 265789/28104 |   176/    0 |
| printUint32AsFloat3To()                | 265805/28104 |   192/    0 |
|----------------------------------------+--------------+-------------|
| printReplaceCharTo(char*)              | 265665/28100 |    52/   -4 |
| printReplaceCharTo(F())                | 265665/28104 |    52/    0 |
| printReplaceStringTo(char*)            | 265701/28104 |    88/    0 |
| printReplaceStringTo(F())              | 265717/28100 |   104/   -4 |
|----------------------------------------+--------------+-------------|
| hashDjb2(char*)                        | 265645/28104 |    32/    0 |
| hashDjb2(F())                          | 265685/28104 |    72/    0 |
|----------------------------------------+--------------+-------------|
| udiv1000()                             | 265677/28104 |    64/    0 |
| /1000                                  | 265677/28104 |    64/    0 |
|----------------------------------------+--------------+-------------|
| isSorted()                             | 265645/28104 |    32/    0 |
| reverse()                              | 265661/28104 |    48/    0 |
|----------------------------------------+--------------+-------------|
| KString::compareTo(char*)              | 265817/28132 |   204/   28 |
| KString::compareTo(KString&)           | 265941/28120 |   328/   16 |
|----------------------------------------+--------------+-------------|
| backslashXEncode()                     | 265877/28104 |   264/    0 |
| backslashXDecode()                     | 265929/28116 |   316/   12 |
+---------------------------------------------------------------------+

```

## ESP32

* ESP32-01 Dev Board, 240 MHz Tensilica LX6
* Arduino IDE 1.8.19, Arduino CLI 0.20.2
* ESP32 Boards 2.0.2

```
+---------------------------------------------------------------------+
| Functionality                          |  flash/  ram |       delta |
|----------------------------------------+--------------+-------------|
| Baseline                               | 230913/16332 |     0/    0 |
|----------------------------------------+--------------+-------------|
| String                                 | 231269/16332 |   356/    0 |
| PrintStr<16>                           | 231165/16332 |   252/    0 |
| PrintStrN(16)                          | 232425/16332 |  1512/    0 |
|----------------------------------------+--------------+-------------|
| printPad2()                            | 230989/16332 |    76/    0 |
| printPad5()                            | 231009/16332 |    96/    0 |
| printUint16AsFloat3To()                | 230997/16332 |    84/    0 |
| printUint32AsFloat3To()                | 231017/16332 |   104/    0 |
|----------------------------------------+--------------+-------------|
| printReplaceCharTo(char*)              | 230941/16332 |    28/    0 |
| printReplaceCharTo(F())                | 230941/16332 |    28/    0 |
| printReplaceStringTo(char*)            | 230977/16332 |    64/    0 |
| printReplaceStringTo(F())              | 230977/16332 |    64/    0 |
|----------------------------------------+--------------+-------------|
| hashDjb2(char*)                        | 230945/16332 |    32/    0 |
| hashDjb2(F())                          | 230953/16332 |    40/    0 |
|----------------------------------------+--------------+-------------|
| udiv1000()                             | 230993/16332 |    80/    0 |
| /1000                                  | 230977/16332 |    64/    0 |
|----------------------------------------+--------------+-------------|
| isSorted()                             | 230945/16332 |    32/    0 |
| reverse()                              | 230949/16332 |    36/    0 |
|----------------------------------------+--------------+-------------|
| KString::compareTo(char*)              | 231093/16332 |   180/    0 |
| KString::compareTo(KString&)           | 231177/16332 |   264/    0 |
|----------------------------------------+--------------+-------------|
| backslashXEncode()                     | 231133/16332 |   220/    0 |
| backslashXDecode()                     | 231197/16332 |   284/    0 |
+---------------------------------------------------------------------+

```

RAM usage remains constant as more objects are created, which indicates that an
initial pool of a certain minimum size is created regardless of the actual RAM
usage by objects.

## Teensy 3.2

* 96 MHz ARM Cortex-M4
* Arduino IDE 1.8.19, Arduino CLI 0.20.2
* Teensyduino 1.56

```
+---------------------------------------------------------------------+
| Functionality                          |  flash/  ram |       delta |
|----------------------------------------+--------------+-------------|
| Baseline                               |  11364/ 4276 |     0/    0 |
|----------------------------------------+--------------+-------------|
| String                                 |  13836/ 4276 |  2472/    0 |
| PrintStr<16>                           |  11584/ 4276 |   220/    0 |
| PrintStrN(16)                          |  11620/ 4276 |   256/    0 |
|----------------------------------------+--------------+-------------|
| printPad2()                            |  11396/ 4276 |    32/    0 |
| printPad5()                            |  11416/ 4276 |    52/    0 |
| printUint16AsFloat3To()                |  11404/ 4276 |    40/    0 |
| printUint32AsFloat3To()                |  11408/ 4276 |    44/    0 |
|----------------------------------------+--------------+-------------|
| printReplaceCharTo(char*)              |  11396/ 4276 |    32/    0 |
| printReplaceCharTo(F())                |  11396/ 4276 |    32/    0 |
| printReplaceStringTo(char*)            |  11420/ 4276 |    56/    0 |
| printReplaceStringTo(F())              |  11420/ 4276 |    56/    0 |
|----------------------------------------+--------------+-------------|
| hashDjb2(char*)                        |  11392/ 4276 |    28/    0 |
| hashDjb2(F())                          |  11404/ 4276 |    40/    0 |
|----------------------------------------+--------------+-------------|
| udiv1000()                             |  11408/ 4276 |    44/    0 |
| /1000                                  |  11400/ 4276 |    36/    0 |
|----------------------------------------+--------------+-------------|
| isSorted()                             |  11388/ 4276 |    24/    0 |
| reverse()                              |  11392/ 4276 |    28/    0 |
|----------------------------------------+--------------+-------------|
| KString::compareTo(char*)              |  11556/ 4276 |   192/    0 |
| KString::compareTo(KString&)           |  11600/ 4276 |   236/    0 |
|----------------------------------------+--------------+-------------|
| backslashXEncode()                     |  11608/ 4276 |   244/    0 |
| backslashXDecode()                     |  11672/ 4276 |   308/    0 |
+---------------------------------------------------------------------+

```

